:root {
  --bg: #0b0f14;
  --card: #121922;
  --muted: #8aa0b3;
  --text: #dde7f1;
  --primary: #3aa2ff;
  --accent: #7bf1a8;
  --ring: rgba(58,162,255,.35);
}

* { box-sizing: border-box; }
html, body { height: 100%; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
  background: radial-gradient(1200px 800px at 20% -10%, #18212b, #0b0f14);
  color: var(--text);
}

/* Topbar */
.topbar {
  display: flex; align-items: center; justify-content: space-between;
  padding: .75rem 1rem; border-bottom: 1px solid #1e2a37; backdrop-filter: blur(8px);
  position: sticky; top: 0; background: rgba(11,15,20,.7); z-index: 10;
}
.brand { font-weight: 700; letter-spacing: .3px; }
.session { display: flex; gap: .5rem; flex-wrap: wrap; align-items: center; }

/* Inputs & buttons */
label { font-size: .8rem; display: grid; gap: .25rem; color: var(--muted); }
input, select, button {
  padding: .55rem .7rem; border-radius: .6rem;
  border: 1px solid #263445; background: #0f1620; color: var(--text);
}
input:focus, select:focus {
  outline: none; border-color: var(--primary); box-shadow: 0 0 0 .2rem var(--ring);
}

button {
  cursor: pointer; border: 1px solid #2b3b4f; background: #16202b;
  transition: transform .04s ease, filter .12s ease;
}
button.primary { background: #1b2938; border-color: #34516e; }
button.accent  { background: #183225; border-color: #2f6e4f; }
button:hover   { filter: brightness(1.08); }
button:active  { transform: translateY(1px); }

/* ===== App grid layout ===== */
.wrap {
  max-width: 1200px;
  margin: 1rem auto;
  padding: 0 .75rem;
  display: grid;
  gap: 1rem;
  grid-template-areas:
    "score  score"
    "roller feed"
    "scene  feed";
  grid-template-columns: minmax(560px, 2fr) minmax(340px, 1fr);
  align-items: start;
}
.scoreboard { grid-area: score; }
.roller     { grid-area: roller; }
.scene      { grid-area: scene; }
.feed       { grid-area: feed; }

@media (max-width: 980px) {
  .wrap {
    grid-template-areas:
      "score"
      "roller"
      "scene"
      "feed";
    grid-template-columns: 1fr;
  }
}

/* Karty */
.card {
  background: var(--card);
  border: 1px solid #1e2a37;
  border-radius: 1rem;
  padding: 1rem 1.1rem;
  box-shadow: 0 6px 18px rgba(0,0,0,.22);
}
.card h2 {
  margin: .1rem 0 1rem;
  font-size: 1.1rem;
  letter-spacing: .3px;
}

/* Roller řádek */
.roller .grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr auto; /* kostka / počet / modifikátor / akce */
  gap: .6rem;
}
.actions { display: flex; flex-wrap: wrap; gap: .5rem; align-items: end; }
.hint { color: var(--muted); margin-top: .5rem; }

/* Feed (výsledky) */
.feed.card { position: sticky; top: 80px; align-self: start; }
.feedList { display: grid; gap: .6rem; max-height: calc(100vh - 240px); overflow: auto; padding-right: .4rem; }

.item {
  padding: .7rem .8rem; border: 1px solid #2a3b50; border-radius: .7rem; background: #0f1620;
}
.item .meta { display: flex; justify-content: space-between; color: var(--muted); font-size: .85rem; }
.item .res  { margin-top: .35rem; display: flex; align-items: center; gap: .6rem; flex-wrap: wrap; }

.badge { padding: .2rem .45rem; border-radius: .5rem; border: 1px solid #2a3b50; }
.die   { border: 1px dashed #30465d; border-radius: .4rem; padding: .2rem .4rem; font-variant-numeric: tabular-nums; }
.total { padding: .2rem .45rem; border-radius: .5rem; background: #163023; border: 1px solid #2f6e4f; }
.sys   { color: var(--muted); font-style: italic; }

/* Dice animation + highlights */
@keyframes dice-wiggle {
  0% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-4px) rotate(6deg); }
  100% { transform: translateY(0) rotate(0deg); }
}
.die.rolling { animation: dice-wiggle 0.6s ease-in-out infinite; opacity: .95; }
.die.nat20   { background: #173b26; border-color: #2f6e4f; font-weight: 700; }
.die.nat1    { background: #3b1a1a; border-color: #8a3c3c; font-weight: 700; }

/* 3D scéna – světlejší background, bez “předělu” */
#dice3d {
  width: 100%;
  aspect-ratio: 16 / 9;
  background: radial-gradient(900px 500px at 35% -15%, #131c27, #0f151d);
  border: 1px solid #1e2a37;
  border-radius: .9rem;
  overflow: hidden;
}
#dice3d canvas { width: 100%; height: 100%; display: block; }

/* ===== SCOREBOARD ===== */
.scoreboard .scoreGrid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: .75rem;
}
.scCard {
  background: #0f1620;
  border: 1px solid #263445;
  border-radius: .8rem;
  padding: .7rem .8rem;
}
.scHeader {
  display: flex; justify-content: space-between; align-items: baseline;
  margin-bottom: .4rem;
}
.scName { font-weight: 600; }
.scAvg  { color: var(--muted); font-size: .9rem; }
.scLast { display: flex; gap: .6rem; align-items: center; flex-wrap: wrap; }
.scDice { display: flex; gap: .3rem; flex-wrap: wrap; }
.scDie  {
  border: 1px dashed #30465d; border-radius: .5rem;
  padding: .15rem .4rem; font-variant-numeric: tabular-nums;
}
.scDie.nat20 { background: #173b26; border-color: #2f6e4f; font-weight: 700; }
.scDie.nat1  { background: #3b1a1a; border-color: #8a3c3c; font-weight: 700; }
.scTotal {
  margin-left: auto;
  padding: .15rem .5rem;
  border-radius: .55rem;
  background: #163023; border: 1px solid #2f6e4f;
}

/* Mobile tweaks */
@media (max-width: 980px) {
  .feed.card { position: static; }
  .feedList  { max-height: none; }
}
/* ===== Action bar pod formulářem ===== */
.roller .actionBar{
  display: flex;
  gap: .5rem;
  flex-wrap: wrap;
  align-items: center;
  justify-content: flex-end;      /* na široku doprava */
  margin-top: .6rem;
}
.roller .actionBar .spacer{ flex: 1 1 auto; } /* oddělí Zvuk vlevo a zbytek vpravo */

#advBtn, #disBtn, #muteBtn, #exportBtn, #clearBtn{
  background: #16202b; border: 1px solid #2b3b4f; padding: .55rem .7rem; border-radius: .6rem;
}
#advBtn{ border-color: #3f6e3a; }
#disBtn{ border-color: #6e3a3a; }
#muteBtn.active{ background: #1f2f20; border-color: #2f6e4f; }

@media (max-width: 980px){
  .roller .actionBar{ justify-content: flex-start; } /* na mobilu doleva, přirozené řazení */
}

/* ===== Slide-in efekt pro nové položky ve feedu ===== */
@keyframes slide-in-up {
  from { transform: translateY(6px); opacity: 0; }
  to   { transform: translateY(0);   opacity: 1; }
}
.feedList .item.new{
  animation: slide-in-up .22s ease-out both;
}
